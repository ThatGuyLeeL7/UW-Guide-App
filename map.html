<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      #map {
        height: 100%;
      }
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        zoom: 20;
      }
    </style>
    <script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCGzvTo0fh_kx4sNwwukJpIPHRwaIA8rno&loading=async&callback=initMap">
    </script>
    <script>
      let map;
      let marker; 
      const trackLocation = ({ onSuccess, onError = () => { } }) => {
        if('geolocation' in navigator){
          return navigator.geolocation.watchPosition(onSuccess, onError, {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
          });
        }
        else{
          alert("geolocation not supported");
        }
      }
      // function init(){
        // trackLocation({
          // onSuccess: position => 
            // alert(`Lat: ${position.coords.latitude} Lng: ${position.coords.longitude}`),
        // onError: err =>
          // alert(`Error: ${getPositionErrorMessage(err.code) || err.message}`)
        // });
      // }
      
      async function initMap() {
        const { Map } = await google.maps.importLibrary("maps");
        const { AdvancedMarkerElement } = await google.maps.importLibrary("marker");
        const position = { lat: -34.397, lng: 150.644 };
        map = new Map(document.getElementById("map"), {
          center: position,
          zoom: 20,
        });
        const marker = new google.maps.Marker({ map, position: position });
        trackLocation({
          onSuccess: ({ coords: { latitude: lat, longitude: lng } }) => {
            marker.setPosition({ lat, lng });
            map.panTo({ lat, lng });
    },
    onError: err => {
      alert(`Error: ${err.message}`);
    }
});
        // marker = new AdvancedMarkerElement
        // ({
          // map: map,
          // position: position,
        // });
      }
      initMap();
    </script>
  </head>
  <body>
    <div id="map"></div>
  </body>
</html>